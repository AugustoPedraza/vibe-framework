# BMAD Integration Adapter

> Connects Vibe framework to BMAD-METHOD workflows

## Overview

This adapter enables Vibe to:
- Load BMAD agent personas
- Execute BMAD workflows
- Share project context bidirectionally
- Import BMAD planning artifacts

---

## BMAD Location

BMAD can be located at:
1. **Project-local:** `{project}/_bmad/` (preferred)
2. **User-global:** `~/.claude/bmad-method/`

### Detection Order

```
1. Check {project}/_bmad/bmm/config.yaml
2. Check ~/.claude/bmad-method/bmm/config.yaml
3. If neither found, BMAD integration unavailable
```

---

## BMAD Structure Reference

```
_bmad/
├── bmm/
│   ├── config.yaml              # BMAD configuration
│   ├── agents/                  # Agent personas
│   │   ├── ux-designer.md       # Sally
│   │   ├── quick-flow-solo-dev.md # Barry
│   │   ├── pm-ba.md             # Mo
│   │   └── ...
│   └── workflows/               # Workflow definitions
│       ├── 1-analysis/
│       ├── 2-plan-workflows/
│       │   └── create-ux-design/
│       │       └── workflow.md
│       └── ...
├── core/
│   ├── tasks/
│   │   └── workflow.xml         # Workflow executor
│   └── workflows/
│       └── party-mode/
│           └── workflow.md
└── _bmad-output/                # Generated artifacts
    └── planning-artifacts/
        ├── prd.md
        ├── epics.md
        └── architecture.md
```

---

## Configuration Loading

### BMAD Config (`config.yaml`)

```yaml
user_name: "Team Member"
communication_language: "English"
output_folder: "_bmad-output"
```

### Vibe Config Integration

BMAD config values available in Vibe via:
```
{{bmad.user_name}}
{{bmad.output_folder}}
```

---

## Agent Loading

### Available BMAD Agents

| Agent | File | Persona | Use For |
|-------|------|---------|---------|
| Sally | `ux-designer.md` | UX Designer | Deep UX exploration |
| Barry | `quick-flow-solo-dev.md` | Quick Dev | Rapid prototyping |
| Mo | `pm-ba.md` | PM/BA | Business analysis |
| Pip | `data-architect.md` | Data Architect | Schema design |
| Alex | `architect.md` | Tech Lead | Architecture decisions |

### Loading an Agent

When `/vibe ux-design` or similar is invoked:

1. **Read agent file:**
   ```
   {bmad_path}/bmm/agents/ux-designer.md
   ```

2. **Extract persona:**
   - Name, title, identity
   - Communication style
   - Principles

3. **Load into context:**
   - AI adopts persona for duration of workflow
   - Reverts to Vibe default after workflow completes

### Agent Persona Format

```markdown
<agent id="ux-designer" name="Sally" title="UX Designer">
  <persona>
    <role>User Experience Designer + UI Specialist</role>
    <identity>Senior UX Designer with 7+ years...</identity>
    <communication_style>Paints pictures with words...</communication_style>
    <principles>- Every decision serves genuine user needs...</principles>
  </persona>
</agent>
```

---

## Workflow Execution

### Workflow Types

| Type | Handler | Example |
|------|---------|---------|
| `workflow` | Load workflow.xml executor | UX Design |
| `exec` | Direct execution of .md file | Party Mode |

### Executing a Workflow

1. **Load workflow definition:**
   ```
   {bmad_path}/bmm/workflows/{path}/workflow.md
   ```

2. **Parse steps:**
   - Extract numbered steps
   - Identify checkpoints
   - Note output requirements

3. **Execute with checkpoints:**
   - AI completes each step
   - Pauses at checkpoints for user input
   - Saves output after each step

### Party Mode Execution

Party Mode is a special workflow:

1. **Load:**
   ```
   {bmad_path}/core/workflows/party-mode/workflow.md
   ```

2. **Behavior:**
   - Multi-agent discussion
   - Agent switching within single session
   - Convergence toward decisions

---

## Project Context Bridge

### `project-context.md`

This file bridges BMAD and Vibe:

- **Generated by:** `/vibe context`
- **Location:** `{project}/project-context.md`
- **Read by:** Both BMAD agents and Vibe workflows

### Content Synchronization

| Source | Data | Target |
|--------|------|--------|
| BMAD screen specs | Screen-level specs, acceptance criteria | project-context.md |
| BMAD epics.md | Stories (legacy format) | project-context.md |
| Vibe features/*.md | Feature specs, status | project-context.md |
| project-context.md | Unified view | BMAD agents |

---

## Screen Spec Pipeline

Screen specs are the **primary work item format** for BMAD→Vibe integration. Each screen spec is an atomic unit of work that maps to a single `/vibe` run.

### Pipeline Flow

```
BMAD UX Design → Screen Specs → /vibe [SPEC-ID] → Small PR
```

### Configuration

Screen spec paths are configured in `vibe.config.json`:

```json
{
  "bmad": {
    "enabled": true,
    "screen_specs_path": "_bmad-output/implementation-artifacts/screen-specs/",
    "screen_spec_template": "_bmad/bmm/templates/screen-spec-template.md"
  },
  "patterns": {
    "catalog_path": "docs/domain/ui-ux/patterns/",
    "screen_types_path": "docs/domain/ui-ux/patterns/screen-types.md"
  }
}
```

### Integration Files

| File | Purpose |
|------|---------|
| `integrations/bmad-screen-specs.md` | How vibe reads and implements screen specs |
| `integrations/screen-spec-reader.md` | Parsing instructions for screen spec format |

### Workflow

1. BMAD generates screen specs at `{bmad.screen_specs_path}`
2. `/vibe [SPEC-ID]` reads the spec, loads referenced patterns from `{patterns.catalog_path}`
3. Vibe maps spec sections to implementation phases and agents
4. Each spec produces a focused PR (~200-400 lines)

---

## Artifact Import

### BMAD → Vibe Conversion

**Screen Specs → Implementation** (primary)

```
{bmad.screen_specs_path}/[FEAT-ID]-[NUM].md
         ↓ /vibe [SPEC-ID]
Small, focused PR per screen spec
```

**Stories → Feature Specs** (legacy)

```
_bmad-output/epics.md (Story)
         ↓ /vibe convert-story
docs/domain/features/{area}/{ID}.md (Feature Spec)
```

**UX Design → ui_spec**

```
_bmad-output/ux-design-{feature}.md
         ↓ Manual conversion
Feature spec ui_spec block
```

### Vibe → BMAD Reference

BMAD agents can reference Vibe artifacts:

```yaml
# In BMAD workflow
references:
  - path: docs/domain/features/
    type: feature-specs
  - path: components.json
    type: component-api
```

---

## Command Mapping

### Vibe → BMAD

| Vibe Command | BMAD Equivalent |
|--------------|-----------------|
| `/vibe ux-design` | Sally agent + UX workflow |
| `/vibe research` | Research workflow |
| `/vibe party` | Party Mode |

### BMAD → Vibe

| BMAD Menu | Vibe Equivalent |
|-----------|-----------------|
| UX Design | `/vibe ux-design` |
| Party Mode | `/vibe party` |
| Workflow Status | `/vibe status` |

---

## Update Management

### Checking for Updates

```bash
# If using git-based BMAD
cd ~/.claude/bmad-method && git fetch
git log HEAD..origin/main --oneline
```

### Update Command

Add to Vibe:

```bash
/vibe bmad-update
```

**Behavior:**
1. Check for updates
2. Show changelog
3. Prompt for update
4. Pull if approved

### Breaking Changes

If BMAD update includes breaking changes:
- Show warning before update
- List affected workflows
- Require explicit confirmation

---

## Troubleshooting

### "BMAD not found"

```
BMAD integration unavailable.

To install:
  git clone https://github.com/bmad-method/bmad-method.git ~/.claude/bmad-method

Or if BMAD is in your project:
  Verify _bmad/bmm/config.yaml exists
```

### "Workflow file missing"

```
Workflow not found: {path}

This may be a new workflow not yet implemented.
Check BMAD documentation or use /vibe party to discuss alternatives.
```

### "Agent persona incomplete"

```
Agent {name} missing required fields.

Required: name, title, persona.role, persona.identity
Check: {bmad_path}/bmm/agents/{file}
```

---

## Integration Checklist

When using BMAD integration:

- [ ] BMAD installed (project or user level)
- [ ] config.yaml readable
- [ ] project-context.md generated (`/vibe context`)
- [ ] Output folder writable
- [ ] Agent files accessible

---

## Best Practices

### When to Use BMAD vs Vibe

| Scenario | Use |
|----------|-----|
| Simple feature implementation | Vibe (`/vibe [ID]`) |
| Major UX exploration | BMAD (`/vibe ux-design`) |
| Architecture discussion | BMAD (`/vibe party`) |
| Quick bug fix | Vibe (`/vibe quick`) |
| New domain research | BMAD (`/vibe research domain`) |
| Sprint planning | Vibe (`/vibe plan`) |
| Technical spike | BMAD (`/vibe research technical`) |

### Workflow Composition

Common patterns:

**New Major Feature:**
```
/vibe research domain → /vibe ux-design → /vibe generate → /vibe [ID]
```

**Architecture Decision:**
```
/vibe research technical → /vibe party → (document decision) → /vibe [ID]
```

**Sprint Planning:**
```
/vibe convert-story (batch) → /vibe plan → /vibe sync
```

---

## Anti-Patterns

- Never mix BMAD and Vibe workflows in same session without checkpoint
- Never skip project-context.md generation before using BMAD agents
- Never assume BMAD output format (always parse)
- Never modify BMAD core files (use project-level overrides)
- Never ignore BMAD checkpoints (they exist for quality)
