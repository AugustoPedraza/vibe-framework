{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://vibe.claude.ai/schemas/active-features.schema.json",
  "title": "Active Features State",
  "description": "Tracks currently running features for parallel development coordination",
  "type": "object",
  "required": ["version", "features"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "const": "1.0.0"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Last update timestamp (ISO 8601)"
    },
    "features": {
      "type": "object",
      "description": "Map of feature ID to feature state",
      "additionalProperties": {
        "$ref": "#/$defs/ActiveFeature"
      }
    }
  },
  "$defs": {
    "ActiveFeature": {
      "type": "object",
      "description": "State of an active feature",
      "required": ["status", "phase", "progress", "files_owned", "started_at"],
      "properties": {
        "status": {
          "type": "string",
          "enum": ["in_progress", "paused", "completing"],
          "description": "Current feature status"
        },
        "phase": {
          "type": "integer",
          "minimum": 0,
          "maximum": 5,
          "description": "Current phase (0-5)"
        },
        "progress": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Overall progress percentage"
        },
        "worktree": {
          "type": ["string", "null"],
          "description": "Path to git worktree if using parallel development, null if in main worktree"
        },
        "files_owned": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "File/directory paths this feature owns (for collision detection)"
        },
        "started_at": {
          "type": "string",
          "format": "date-time",
          "description": "Feature start timestamp (ISO 8601)"
        },
        "contract_path": {
          "type": "string",
          "description": "Path to feature contract file"
        },
        "last_activity": {
          "type": "string",
          "format": "date-time",
          "description": "Last activity timestamp for staleness detection"
        }
      }
    }
  },
  "examples": [
    {
      "version": "1.0.0",
      "updated_at": "2026-02-02T10:30:00Z",
      "features": {
        "AUTH-001": {
          "status": "in_progress",
          "phase": 2,
          "progress": 65,
          "worktree": null,
          "files_owned": [
            "lib/accounts/",
            "assets/svelte/auth/",
            "test/accounts/"
          ],
          "started_at": "2026-02-02T10:00:00Z",
          "contract_path": ".claude/contracts/AUTH-001.json",
          "last_activity": "2026-02-02T10:25:00Z"
        },
        "BILLING-001": {
          "status": "in_progress",
          "phase": 1,
          "progress": 30,
          "worktree": "../project-BILLING-001",
          "files_owned": [
            "lib/billing/",
            "assets/svelte/billing/",
            "test/billing/"
          ],
          "started_at": "2026-02-02T10:15:00Z",
          "contract_path": ".claude/contracts/BILLING-001.json",
          "last_activity": "2026-02-02T10:28:00Z"
        }
      }
    },
    {
      "version": "1.0.0",
      "updated_at": "2026-02-02T09:00:00Z",
      "features": {}
    }
  ]
}
